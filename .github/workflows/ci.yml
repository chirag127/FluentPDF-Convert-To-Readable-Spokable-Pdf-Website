name: CI

# This workflow will do a clean install of dependencies, build, test and deploy your code with
# a single API key
#
# To deploy, you must set the GITHUB_API_TOKEN environment variable in your repository settings.
# For more information see: https://docs.github.com/en/actions/security-guides/encrypted-secrets

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4

    # Setup Node.js for Vite and frontend dependencies
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20.x' # Use a recent LTS version
        cache: 'npm'

    # Install project dependencies using npm (Vite, React, TailwindCSS)
    - name: Install Dependencies
      run: npm ci

    # Run Biome for linting and formatting checks
    - name: Run Biome Check
      run: npx @biomejs/biome check . --apply

    # Build the Vite application
    - name: Build Vite App
      run: npm run build

    # Run Vitest for unit and integration tests
    - name: Run Vitest
      run: npm run test:unit

    # --- IMPORTANT: The following steps are for a Python backend/CLI scenario --- 
    # Since this repo is TypeScript/Vite/React, these Python steps are NOT applicable.
    # If there were a Python component, the following would be relevant:
    
    # Setup Python environment
    # - name: Setup Python
    #   uses: actions/setup-python@v5
    #   with:
    #     python-version: '3.10'
    #     cache: 'uv'
    #
    # Install Python dependencies with uv
    # - name: Install Python Dependencies
    #   run: |
    #     uv install --frozen --yes
    #
    # Run Ruff for Python linting and formatting
    # - name: Run Ruff Check
    #   run: ruff check .
    #   continue-on-error: true # Or set to false for strict enforcement
    #
    # Run Pytest for Python tests
    # - name: Run Pytest
    #   run: pytest

    # For E2E tests using Playwright (if applicable and configured)
    # Requires setup for browsers
    - name: Setup Playwright Browsers
      run: npx playwright install

    - name: Run Playwright E2E Tests
      run: npm run test:e2e
